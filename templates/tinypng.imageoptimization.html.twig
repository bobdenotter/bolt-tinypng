{% extends '_base/_page-nav.twig' %}
{% from '@bolt/_buic/_moment.twig' import buic_moment %}

{% block page_nav title %}

{% block page_title __("TinyPNG & TinyJPG Image Optimization for Bolt") %}




{% block page_main %}
    <div class="row">
        <div class="col-xs-12 col-md-7">
            <p>
                Use TinyPNG and TinyJPG API to optimize your images.
            </p>
        </div>
        <div class="col-xs-12 col-md-5">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Compressions Made</h3>
                </div>
                <div class="panel-body">
                    <p>
                        You Have Made {{ compressionCount }} Compressions This Month
                    </p>
                </div>
            </div>
        </div>
        <div class="col-xs-12">
            <table class="dashboardlisting" data-bolt-path="{{ paths.bolt }}">
                <thead>
                <tr>
                    <th>Files To Optimize</th>
                    <th>Size</th>
                    <th>Optimize</th>
                </tr>
                </thead>
                <tbody>

                   {% for obj, key in tinyPNG_files %}
                       <tr>
                           <td>
                               <i class="fa fa-fw fa-file-image-o"></i>
                               <a href="{{ key.imagePath|thumbnail(1000, 1000, 'r')  }}"
                                  class="magnific"
                                  title="Image: {{ key.filename }}">
                                   <strong>{{ key.filename }}</strong>
                               </a>
                               <br>
                               <strong>Location:</strong> {% if key.located %}{{ key.located }}{% else %}Files{% endif %}
                           </td>
                           <td class="listthumb">
                               {{ key.imagePath|showimage(54, 40, 'c')|replace({'alt=""': 'alt="' ~ __('general.phrase.thumbnail')|e('html_attr') ~ '"'})|raw }}
                           </td>
                           <td class="hidden-xs hidden-sm">
                               <strong>{{ key.filesize }}</strong>
                           </td>

                        <td>
                            <div class="btn-group">
                                <button class="btn btn-default btn-sm tinyPNG-optimize"
                                        data-imagePath="{{ key.imagePath }}">
                                    optimize image
                                </button>
                                <button  class="btn btn-default btn-sm" data-toggle="modal" data-target="#renameModal">
                                    Optimize &amp; Rename
                                </button>
                            </div>

                        </td>

                       </tr>
                       {% endfor %}
                </tbody>
            </table>
        </div>
        <div class="col-xs-12 ajax-error">

        </div>
    </div>
<!-- modal -->
    <div class="modal fade" id="renameModal" tabindex="-1" role="dialog"
         aria-labelledby="{{ loop.index }}-modal-label">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"
                            aria-label="Close"><span aria-hidden="true">&times;</span>
                    </button>
                    <h4 class="modal-title" id="{{ loop.index }}-modal-label">Optimize &amp
                        Rename: {{ key.filename }}</h4>
                </div>
                <div class="modal-body">
                    <p>
                        This will optimize your image and save it under the name you choose
                        below in the text input box.
                    </p>
                    <form class="form-horizontal">
                        <div class="form-group">
                            <label for="{{ loop.index }}-newname" class="col-sm-2 control-label">Name</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control"id="{{ loop.index }}-newname" placeholder="Enter New Image Name">
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-offset-2 col-sm-10">
                                <button type="submit" class="btn btn-default">Save &amp Optimize</button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>
{% endblock page_main %}